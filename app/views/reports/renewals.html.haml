- content_for :subtitle do
  Reports

%ul{:id => 'submenu', :class => 'sub_menu'}
  %li
    = link_to 'Dashboard', reports_path
  %li
    = link_to 'Renewals', {:controller => "reports", :action => "renewals"}, :class => 'active'
  %li
    = link_to 'Inventory', {:controller => "reports", :action => "sparesreq"}
  %li
    = link_to 'Customers', {:controller => "reports", :action => "customers"}

%p &nbsp;
  
#section1
  %table{:class => 'plain_table'}
    %tr
      %td{:width => '300px', :style => 'valign:bottom'}
        %h2{:margin => '0'}
          Renewals &nbsp;&nbsp;&nbsp;
          %span{:style => 'font-size:8pt;text-transform:lowercase'}= link_to_function 'Format for print', "toggleHeaderStuff()"
      %td
        Filter by Office
        =select("filter", "offices", @offices, {:include_blank => true },{:onchange => 'return toggleOffices()', :style => "width: 82px"})
      %td{:width => '325px', :align => 'right'}
        - form_tag'/reports/renewals', {:name => 'date_search' }  do
          = text_field 'date_search', 'ref_date', {:size => 10, :value => @ref_date}
          = submit_tag "Search"
  
  %h2{:style => 'margin:15px 0px 0px 300px'} EXPIRED CONTRACTS
  
  %table{:class => "sortable", :padding => '2', :border => '1', :width => '800px', :style => 'background:#ff5455'}
    %thead
      %tr
        %th{:width => '80px', :ts_type => 'string'}
          %b Office
        %th{:width => '160px', :ts_type => 'string'}
          %b Account
        %th{:width => '250px', :ts_type => 'string'}
          %b Description
        %th{:width => '70px'}
          %b Start Date
        %th{:width => '70px'}
          %b End Date
        %th{:width => '50px', :ts_type => 'number'}
          %b Days Due
        %th{:width => '100px', :ts_type => 'money'}
          %b Revenue
    %tbody
      - for x in @contracts
        - if x.days_due.to_i <= 0
          %tr{:id => x.sales_office_name}
            %td= h x.sales_office_name
            %td= h x.account_name
            %td= link_to x.description, contract_url(x.id)
            %td{:align => 'center'}= h x.start_date
            %td{:align => 'center'}= h x.end_date
            %td{:align => 'right'}= h x.days_due
            %td{:align => 'right'}= number_to_currency(x.revenue, :format => '%n')

  %h2{:style => 'margin:15px 0px 0px 250px'} Contracts expiring in 30 days or less
  
  %table{:class => "sortable", :padding => '2', :border => '1', :width => '800px', :style => 'background:#ffff66'}
    %thead
      %tr
        %th{:width => '80px'}
          %b Office
        %th{:width => '160px'}
          %b Account
        %th{:width => '250px'}
          %b Description
        %th{:width => '70px'}
          %b Start Date
        %th{:width => '70px'}
          %b End Date
        %th{:width => '50px'}
          %b Days Due
        %th{:width => '100px'}
          %b Revenue
    %tbody
      - for x in @contracts
        - if x.days_due.to_i > 0 && x.days_due.to_i <= 30
          %tr{:id => x.sales_office_name}
            %td= h x.sales_office_name
            %td= h x.account_name
            %td= link_to x.description, contract_url(x.id)
            %td{:align => 'center'}= h x.start_date
            %td{:align => 'center'}= h x.end_date
            %td{:align => 'right'}= h x.days_due
            %td{:align => 'right'}= number_to_currency(x.revenue, :format => '%n')

  %h2{:style => 'margin:15px 0px 0px 250px'} Contracts expiring in 31 to 60 days
  
  %table{:class => "sortable", :padding => '2', :border => '1', :width => '800px', :style => 'background:#ffff66'}
    %thead
      %tr
        %th{:width => '80px'}
          %b Office
        %th{:width => '160px'}
          %b Account
        %th{:width => '250px'}
          %b Description
        %th{:width => '70px'}
          %b Start Date
        %th{:width => '70px'}
          %b End Date
        %th{:width => '50px'}
          %b Days Due
        %th{:width => '100px'}
          %b Revenue
    %tbody
      - for x in @contracts
        - if x.days_due.to_i > 30 && x.days_due.to_i <= 60
          %tr{:id => x.sales_office_name}
            %td= h x.sales_office_name
            %td= h x.account_name
            %td= link_to x.description, contract_url(x.id)
            %td{:align => 'center'}= h x.start_date
            %td{:align => 'center'}= h x.end_date
            %td{:align => 'right'}= h x.days_due
            %td{:align => 'right'}= number_to_currency(x.revenue, :format => '%n')

  %h2{:style => 'margin:15px 0px 0px 250px'} Contracts expiring in 61 to 90 days
  
  %table{:class => "sortable", :padding => '2', :border => '1', :width => '800px'}
    %thead
      %tr
        %th{:width => '80px'}
          %b Office
        %th{:width => '160px'}
          %b Account
        %th{:width => '250px'}
          %b Description
        %th{:width => '70px'}
          %b Start Date
        %th{:width => '70px'}
          %b End Date
        %th{:width => '50px'}
          %b Days Due
        %th{:width => '80px'}
          %b Revenue
    %tbody
      - for x in @contracts
        - if x.days_due.to_i > 60 && x.days_due.to_i <= 90
          %tr{:id => x.sales_office_name}
            %td= h x.sales_office_name
            %td= h x.account_name
            %td= link_to x.description, contract_url(x.id)
            %td{:align => 'center'}= h x.start_date
            %td{:align => 'center'}= h x.end_date
            %td{:align => 'right'}= h x.days_due
            %td{:align => 'right'}= number_to_currency(x.revenue, :format => '%n')
          
